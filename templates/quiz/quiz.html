{% extends 'base.html'%}
{% load static %}
{% block content %} 
<div class="container">
    <div align="right " id="displaytimer"><b>Timer: 0 seconds</b></div>

    <form method='post' action=''>
        {% csrf_token %}
        <div class="mainform" id="mainform">
        {% for q in page_obj %}
        
            <div class="form-group">
                <label for="question">{{q.question_text}}</label>
                <img src="{{q.url_image}}" alt="">
            </div>

            <div class="form-check">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="{{q.question_text}}" id="gridRadios1" value="{{q.answer1}}" checked>
                    <label class="form-check-label" for="gridRadios1">
                    {{q.answer1}}
                    </label>
                </div>

                <div class="form-check">
                    <input class="form-check-input" type="radio" name="{{q.question_text}}" id="gridRadios2" value="{{q.answer2}}">
                    <label class="form-check-label" for="gridRadios2">
                    {{q.answer2}}
                    </label>
                </div>

                <div class="form-check">
                    <input class="form-check-input" type="radio" name="{{q.question_text}}" id="gridRadios3" value="{{q.answer3}}">
                    <label class="form-check-label" for="gridRadios3">
                    {{q.answer3}}
                    </label>
                </div>

                <div class="form-check">
                    <input class="form-check-input" type="radio" name="{{q.question_text}}" id="gridRadios4" value="{{q.answer4}}">
                    <label class="form-check-label" for="gridRadios4">
                    {{q.answer4}}
                    </label>
                </div>

                <br>
            </div>  
        
        {% endfor %}
        </div>

        <nav aria-label="Page navigation example" id="pagination"> 
            <ul class="pagination">
                {% for i in page_obj.paginator.page_range %}
                {% if page_obj.number == i %}
                <li class="page-item active"><a class="page-link" href="{{ request.path }}?page={{ i }}">{{i}}</a></li>
                <!-- <li class="page-item"><a class="page-link" href="?page={{ forloop.counter }}">{{forloop.counter}}</a></li> -->
                {% else %}
                <li class="page-item"><a class="page-link" href="{{ request.path }}?page={{ i }}">{{i}}</a></li>
                {% endif %}
                {% endfor %}
            </ul>
        </nav>
        
        <input id='timer' type='hidden' name="timer" value="">
        <br>
        <button type="submit" class="btn btn-primary">Завершить</button>

      </form>

    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script type="text/javascript">

        // console.log('hello world')
        const timer=document.getElementById('displaytimer')
        // console.log(timer.textContent)
        const inputtag = document.getElementById('timer')

        t=0
        setInterval(()=>{
            t+=1
            timer.innerHTML ="<b>Timer: " +t+" seconds</b>"
            inputtag.value = t
        },1000)

        function ajaxPagination() {
            $('#pagination a.page-link').each((index, el) => {
                $(el).click((e) => {
                    e.preventDefault()
                    let page_url = $(el).attr('href')
                    console.log(page_url)

                    $.ajax({
                        url: page_url,
                        type: 'GET',
                        success: (data) => {
                            $('#mainform').empty()
                            $('#mainform').append($(data).filter('#mainform').html)

                            $('#pagination').empty()
                            $('#pagination').append($(data).filter('#pagination').html)
                        }
                    })
                })
            })
        }
        
        // $(document).ready(function(){
        //     ajaxPagination()
        // })

        // $(document).ajaxStop(function(){
        //     ajaxPagination()
        // })

    </script>
{% endblock %}